<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
		 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xmlns:secu="http://www.springframework.org/schema/security"
		 xsi:schemaLocation="http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/security https://www.springframework.org/schema/security/spring-security.xsd">
						
    <bean id="usuarioDetailsService" class="com.security.services.UsuarioDetailsService" />
	<bean id="passwordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder" />
	<bean id="authFailureHandler" class="com.security.RexpresAuthenticationFailureHandler"/>
	<bean id="accessDeniedHandler" class="com.security.RexpresAccessDeniedHandler"/>
	<secu:http auto-config="true" create-session="never" use-expressions="false" >
		<secu:csrf disabled="true" />
		<secu:http-basic />
		<secu:headers>
			<secu:frame-options policy="SAMEORIGIN" />
			<secu:hsts disabled="true"/>
		</secu:headers>
		<!-- <secu:intercept-url pattern="/*" access="ROLE_ADMIN" /> -->
        <secu:intercept-url pattern="/views/admin/*" access="ROLE_ADM" />
        <secu:intercept-url pattern="/modulo/*" access="ROLE_USU"/>
		<secu:intercept-url pattern="/rexpres/javax.faces.resource/*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <secu:form-login login-page="/loginView.xhtml" 
                         login-processing-url="/appLogin"
                         username-parameter="rex:username"
		   				 password-parameter="rex:password"
		   				 authentication-failure-handler-ref="authFailureHandler"
		   				 default-target-url="/views/admin/aplicaciones.xhtml" />
		<secu:logout logout-url="/appLogout" logout-success-url="/loginView.xhtml"/> 
		<secu:access-denied-handler ref="accessDeniedHandler"/>
<!-- 		<custom-filter ref="jwtFilter" before="FORM_LOGIN_FILTER"/>
<custom-filter ref="auditFilter" after="SECURITY_CONTEXT_FILTER"/> -->
		<!-- <secu:access-denied-handler error-page="/loginView.xhtml"/> -->
		<!-- authentication-failure-url="/loginView.xhtml?error=true" -->
	</secu:http>
	<secu:authentication-manager>
		 <secu:authentication-provider
			user-service-ref="usuarioDetailsService">
			<secu:password-encoder ref="passwordEncoder" />
		</secu:authentication-provider> 
	</secu:authentication-manager>
</beans>
